# Деплой сайта на GitHub Pages с доменом happy-habits.ru

## Предварительные требования

- GitHub аккаунт
- Git установлен локально
- Доступ к управлению DNS записями домена happy-habits.ru

---

## Шаг 1: Подготовка репозитория GitHub

### 1.1 Создайте новый репозиторий на GitHub
1. Перейдите на https://github.com/new
2. Введите название репозитория (например: `psych-web` или `happy-habits-website`)
3. Выберите **Public** (для бесплатного GitHub Pages)
4. **НЕ** инициализируйте с README, .gitignore или лицензией
5. Нажмите **Create repository**

### 1.2 Подключите локальный проект к GitHub

Выполните команды в терминале из папки проекта:

```bash
# Инициализируйте git (если еще не сделано)
git init

# Добавьте все файлы
git add .

# Создайте первый коммит
git commit -m "Initial commit: Hugo psychologist website"

# Добавьте удаленный репозиторий (замените YOUR-USERNAME и REPO-NAME)
git remote add origin https://github.com/YOUR-USERNAME/REPO-NAME.git

# Переименуйте ветку в main (если нужно)
git branch -M main

# Отправьте код на GitHub
git push -u origin main
```

---

## Шаг 2: Настройка GitHub Pages

### 2.1 Включите GitHub Pages
1. Откройте ваш репозиторий на GitHub
2. Перейдите в **Settings** (Настройки)
3. В левом меню выберите **Pages**
4. В секции **Build and deployment**:
   - **Source**: выберите **GitHub Actions**
5. Сохраните настройки

### 2.2 Проверка автоматического деплоя
1. Перейдите во вкладку **Actions** в вашем репозитории
2. Вы должны увидеть запущенный workflow "Deploy Hugo site to GitHub Pages"
3. Дождитесь завершения (зеленая галочка ✓, обычно 1-2 минуты)
4. После успешного деплоя сайт будет доступен по адресу: `https://YOUR-USERNAME.github.io/REPO-NAME/`

---

## Шаг 3: Настройка кастомного домена happy-habits.ru

### 3.1 Настройка DNS записей

Войдите в панель управления вашего регистратора домена (например, REG.RU, Timeweb, etc.) и добавьте следующие DNS записи:

#### A-записи для корневого домена (happy-habits.ru):
```
Тип: A
Имя: @ (или оставьте пустым)
Значение: 185.199.108.153

Тип: A
Имя: @
Значение: 185.199.109.153

Тип: A
Имя: @
Значение: 185.199.110.153

Тип: A
Имя: @
Значение: 185.199.111.153
```

#### CNAME-запись для www (опционально):
```
Тип: CNAME
Имя: www
Значение: YOUR-USERNAME.github.io
```

**Важно**: Замените `YOUR-USERNAME` на ваше имя пользователя GitHub.

### 3.2 Добавьте домен в GitHub Pages

1. Вернитесь в **Settings** → **Pages** вашего репозитория
2. В секции **Custom domain** введите: `happy-habits.ru`
3. Нажмите **Save**
4. Подождите проверки DNS (может занять несколько минут)
5. После успешной проверки отметьте **Enforce HTTPS**

**Примечание**: Генерация SSL-сертификата может занять до 15-20 минут. После этого ваш сайт будет доступен по HTTPS.

---

## Шаг 4: Проверка деплоя

### 4.1 Проверьте DNS
Используйте онлайн-инструменты для проверки DNS:
- https://dnschecker.org
- Введите `happy-habits.ru`
- Убедитесь, что A-записи указывают на IP-адреса GitHub

### 4.2 Проверьте сайт
Откройте в браузере:
- http://happy-habits.ru (должен автоматически перенаправить на HTTPS)
- https://happy-habits.ru

---

## Автоматические обновления

После настройки каждое изменение автоматически деплоится при push в ветку `main`:

```bash
# Внесите изменения в файлы
# Например, отредактируйте контент или CSS

# Добавьте изменения
git add .

# Создайте коммит
git commit -m "Описание изменений"

# Отправьте на GitHub
git push

# Workflow автоматически запустится и обновит сайт через 1-2 минуты
```

Отслеживайте статус деплоя во вкладке **Actions** вашего репозитория.

---

## Локальная разработка

Для тестирования изменений локально перед публикацией:

```bash
# Запустите локальный сервер Hugo
hugo server -D

# Откройте в браузере
# http://localhost:1313

# Сервер автоматически перезагрузится при изменениях файлов
```

---

## Полезные команды

### Сборка сайта локально
```bash
hugo --minify
```

### Очистка кеша
```bash
rm -rf public/ resources/
hugo --gc --minify
```

### Проверка версии Hugo
```bash
hugo version
```

---

## Структура файлов деплоя

Вот файлы, которые были созданы для деплоя:

```
.
├── .github/
│   └── workflows/
│       └── deploy.yml          # GitHub Actions workflow
├── static/
│   └── CNAME                   # Файл с доменом для GitHub Pages
└── DEPLOYMENT.md               # Эта инструкция
```

---

## Устранение неполадок

### Сайт не открывается после настройки DNS
- **Причина**: DNS-записи еще не распространились
- **Решение**: Подождите 1-48 часов для полной propagation DNS

### Ошибка "Domain's DNS record could not be retrieved"
- **Причина**: Неправильные DNS-записи
- **Решение**: Проверьте A-записи, убедитесь, что указали все 4 IP-адреса

### HTTPS не работает
- **Причина**: SSL-сертификат еще не выпущен
- **Решение**: Подождите 15-20 минут после добавления домена

### Workflow завершается с ошибкой
- Проверьте логи во вкладке **Actions**
- Убедитесь, что в Settings → Actions → General разрешены Workflow permissions: Read and write

### Изменения не отображаются на сайте
- Очистите кеш браузера (Cmd+Shift+R на Mac, Ctrl+Shift+R на Windows)
- Проверьте, что workflow успешно завершился (зеленая галочка)

---

## Дополнительные возможности

### Настройка редиректа www → без www
Добавьте в `static/_redirects`:
```
https://www.happy-habits.ru/* https://happy-habits.ru/:splat 301!
```

### Google Analytics
Добавьте в `config.toml`:
```toml
[services.googleAnalytics]
ID = "G-XXXXXXXXXX"
```

### Yandex.Metrika
Добавьте код счетчика в `layouts/partials/footer.html`

---

## Контакты и поддержка

- GitHub Pages документация: https://docs.github.com/en/pages
- Hugo документация: https://gohugo.io/documentation/
- GitHub Actions: https://docs.github.com/en/actions

---

**Готово!** Ваш сайт будет автоматически обновляться при каждом git push.
