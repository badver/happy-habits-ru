(function(){"use strict";const e="happy_habits_ru",a="905071754633",t="Здравствуйте! Хочу записаться на бесплатную диагностику (30 минут)",n=2e3;function s(n=t){const s=encodeURIComponent(n);return`tg://resolve?domain=${e}&text=${s}`}function o(e=t){const n=encodeURIComponent(e);return`https://wa.me/${a}?text=${n}`}function r(t){return t==="telegram"?`https://t.me/${e}`:t==="whatsapp"?`https://web.whatsapp.com/`:""}function c(e,t){const i=t.getAttribute("data-cta"),m=t.getAttribute("data-position")||"unknown";typeof window.trackMessengerClick=="function"&&window.trackMessengerClick(i,m);let a;if(i==="telegram")a=s();else if(i==="whatsapp")a=o();else return;const c=t.getAttribute("data-fallback")||r(i);let l=!1;const f=Date.now(),d=setTimeout(()=>{!l&&Date.now()-f>=n&&(console.log(`Deeplink timeout, redirecting to fallback: ${c}`),window.location.href=c)},n),u=()=>{document.hidden&&(l=!0,clearTimeout(d)),document.removeEventListener("visibilitychange",u)};document.addEventListener("visibilitychange",u);const h=()=>{l=!0,clearTimeout(d),window.removeEventListener("blur",h)};window.addEventListener("blur",h);try{window.location.href=a}catch(e){console.error("Failed to open deeplink:",e),clearTimeout(d),window.location.href=c}e.preventDefault()}function i(){const e=document.querySelectorAll('[data-cta="telegram"], [data-cta="whatsapp"]');e.forEach(e=>{e.addEventListener("click",t=>{c(t,e)})}),console.log(`Initialized ${e.length} deeplink buttons`)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",i):i(),window.buildTelegramDeeplink=s,window.buildWhatsAppDeeplink=o})()