(function(){"use strict";const n="quiz_completed",s="quiz_answers",t=[{id:1,text:"С чем вы хотели бы поработать?",answers:{anxiety:"Тревожность",panic:"Панические атаки",stress:"Стресс и выгорание",ocd:"Навязчивые мысли (ОКР)",other:"Другое"}},{id:2,text:"Как давно вас беспокоит эта проблема?",answers:{less_month:"Менее месяца","1_6_months":"1-6 месяцев","6_12_months":"6-12 месяцев",more_year:"Более года",several_years:"Несколько лет"}},{id:3,text:"Обращались ли вы ранее к психологу или психотерапевту?",answers:{never:"Нет, это будет первый раз",yes_no_help:"Да, но не помогло",yes_positive:"Да, был положительный опыт",working_now:"Работаю сейчас с другим специалистом"}},{id:4,text:"Что для вас важнее всего в терапии?",answers:{quick_result:"Быстрый результат",deep_understanding:"Глубокое понимание проблемы",techniques:"Конкретные техники и упражнения",support:"Поддержка и принятие"}}];let e=1,o={},i=null;function d(){try{return localStorage.getItem(n)==="true"}catch{return!1}}function l(){try{localStorage.setItem(n,"true"),localStorage.setItem(s,JSON.stringify(o))}catch{console.warn("Could not save quiz state to localStorage")}}function a(e,t){if(typeof gtag!="undefined"&&(gtag("event",e,t),console.log("GA4 event:",e,t)),typeof ym!="undefined"){const n=window.YM_ID||document.body.dataset.ymId;n&&(ym(n,"reachGoal",e,t),console.log("YM event:",e,t))}}function u(e,n,s){const o=t.find(t=>t.id===e);a("quiz_answer",{question_id:e,question_text:o?o.text:"",answer_id:n,answer_text:s,step_number:e})}function h(){const e=i?Math.round((Date.now()-i)/1e3):0,n={total_questions:t.length,completion_time_seconds:e,...o};a("quiz_completed",n)}function r(n){const a=document.querySelectorAll(".quiz__question");a.forEach(e=>{e.style.display=e.dataset.question===String(n)?"block":"none"});const s=document.getElementById("quiz-current"),o=document.getElementById("quiz-progress-fill"),i=document.getElementById("quiz-back-btn");s&&(s.textContent=n),o&&(o.style.width=n/t.length*100+"%"),i&&(i.style.display=n>1?"flex":"none"),e=n}function m(n,s){const i=t.find(t=>t.id===e);if(!i)return;o["q"+e]=n,u(e,n,s),e<t.length?r(e+1):p()}function f(){e>1&&r(e-1)}function p(){l(),h(),g()}function g(){const s=document.getElementById("quiz-section");s&&(s.style.display="none");const e=document.querySelector(".cta-final__buttons");e&&(e.classList.remove("quiz-hidden"),e.classList.add("quiz-revealed"));const t=document.querySelector(".cta-final__sla");t&&(t.classList.remove("quiz-hidden"),t.classList.add("quiz-revealed"));const n=document.querySelector(".cta-final__guarantees");n&&(n.classList.remove("quiz-hidden"),n.classList.add("quiz-revealed"));const o=document.querySelectorAll(".footer .social-btn--telegram, .footer .social-btn--whatsapp");o.forEach(e=>{e.classList.remove("quiz-hidden"),e.classList.add("quiz-revealed")})}function v(){const e=document.getElementById("quiz-section");e&&(e.style.display="block");const t=document.querySelector(".cta-final__buttons");t&&t.classList.add("quiz-hidden");const n=document.querySelector(".cta-final__sla");n&&n.classList.add("quiz-hidden");const s=document.querySelector(".cta-final__guarantees");s&&s.classList.add("quiz-hidden");const o=document.querySelectorAll(".footer .social-btn--telegram, .footer .social-btn--whatsapp");o.forEach(e=>{e.classList.add("quiz-hidden")})}function c(){if(d()){const e=document.getElementById("quiz-section");e&&(e.style.display="none"),console.log("Quiz already completed, showing CTA buttons");return}i=Date.now(),v();const t=document.querySelectorAll(".quiz__answer");t.forEach(e=>{e.addEventListener("click",function(){const e=this.dataset.answer,t=this.textContent.trim();m(e,t)})});const e=document.getElementById("quiz-back-btn");e&&e.addEventListener("click",f),console.log("Quiz initialized")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",c):c(),window.quizGate={reset:function(){try{localStorage.removeItem(n),localStorage.removeItem(s),location.reload()}catch{console.warn("Could not reset quiz state")}},getAnswers:function(){try{return JSON.parse(localStorage.getItem(s)||"{}")}catch{return{}}}}})()