(function(){"use strict";const s="quiz_completed",o="quiz_answers",t=[{id:1,text:"С чем вы хотели бы разобраться?",answers:{anxiety:"Тревожность",panic:"Панические атаки",stress:"Стресс и выгорание",ocd:"Навязчивые мысли (ОКР)",other:"Другое"}},{id:2,text:"Как давно вас беспокоит эта проблема?",answers:{less_month:"Менее месяца","1_6_months":"1-6 месяцев","6_12_months":"6-12 месяцев",more_year:"Более года",several_years:"Несколько лет"}},{id:3,text:"Обращались ли вы ранее к психологу или психотерапевту?",answers:{never:"Нет, это будет первый раз",yes_no_help:"Да, но не помогло",yes_positive:"Да, был положительный опыт",working_now:"Работаю сейчас с другим специалистом"}},{id:4,text:"Что для вас важнее всего в терапии?",answers:{quick_result:"Быстрый результат",deep_understanding:"Глубокое понимание проблемы",techniques:"Конкретные техники и упражнения",support:"Поддержка и принятие"}}],y=5;let e=1,i={},a=null;function v(){try{return localStorage.getItem(s)==="true"}catch{return!1}}function h(){try{localStorage.setItem(s,"true"),localStorage.setItem(o,JSON.stringify(i))}catch{console.warn("Could not save quiz state to localStorage")}}function n(e,t){if(typeof gtag!="undefined"&&(gtag("event",e,t),console.log("GA4 event:",e,t)),typeof ym!="undefined"){const n=window.YM_ID||document.body.dataset.ymId;n&&(ym(n,"reachGoal",e,t),console.log("YM event:",e,t))}}function d(e,s,o){const i=t.find(t=>t.id===e);n("quiz_answer",{question_id:e,question_text:i?i.text:"",answer_id:s,answer_text:o,step_number:e})}function u(){const e=a?Math.round((Date.now()-a)/1e3):0,s={total_questions:t.length,completion_time_seconds:e,...i};n("quiz_completed",s)}function r(t){const i=document.querySelectorAll(".quiz__question");i.forEach(e=>{e.style.display=e.dataset.question===String(t)?"block":"none"});const n=document.getElementById("quiz-current"),s=document.getElementById("quiz-progress-fill"),o=document.getElementById("quiz-back-btn");n&&(n.textContent=t),s&&(s.style.width=t/y*100+"%"),o&&(o.style.display=t>1?"flex":"none"),e=t}function m(n,s){const o=t.find(t=>t.id===e);if(!o)return;i["q"+e]=n,d(e,n,s),e<t.length?r(e+1):e===t.length?p():l()}function f(){e>1&&r(e-1)}function p(){r(5),n("quiz_info_step_viewed",{total_questions:t.length})}function g(){n("quiz_info_step_continued",{total_questions:t.length}),l()}function l(){h(),u(),b()}function b(){const o=document.getElementById("quiz-section");o&&(o.style.display="none");const e=document.querySelector(".cta-final__buttons");e&&(e.classList.remove("quiz-hidden"),e.classList.add("quiz-revealed"));const t=document.querySelector(".cta-final__sla");t&&(t.classList.remove("quiz-hidden"),t.classList.add("quiz-revealed"));const n=document.querySelector(".cta-final__guarantees");n&&(n.classList.remove("quiz-hidden"),n.classList.add("quiz-revealed"));const s=document.getElementById("footer-contact-section");s&&(s.classList.remove("quiz-hidden"),s.classList.add("quiz-revealed"))}function j(){const e=document.getElementById("quiz-section");e&&(e.style.display="block");const t=document.querySelector(".cta-final__buttons");t&&t.classList.add("quiz-hidden");const n=document.querySelector(".cta-final__sla");n&&n.classList.add("quiz-hidden");const s=document.querySelector(".cta-final__guarantees");s&&s.classList.add("quiz-hidden");const o=document.getElementById("footer-contact-section");o&&o.classList.add("quiz-hidden")}function c(){if(v()){const e=document.getElementById("quiz-section");e&&(e.style.display="none"),console.log("Quiz already completed, showing CTA buttons");return}a=Date.now(),j();const n=document.querySelectorAll(".quiz__answer");n.forEach(e=>{e.addEventListener("click",function(){const e=this.dataset.answer,t=this.textContent.trim();m(e,t)})});const e=document.getElementById("quiz-back-btn");e&&e.addEventListener("click",f);const t=document.getElementById("quiz-continue-btn");t&&t.addEventListener("click",g),console.log("Quiz initialized")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",c):c(),window.quizGate={reset:function(){try{localStorage.removeItem(s),localStorage.removeItem(o),location.reload()}catch{console.warn("Could not reset quiz state")}},getAnswers:function(){try{return JSON.parse(localStorage.getItem(o)||"{}")}catch{return{}}}}})()